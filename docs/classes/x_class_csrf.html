<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Bugfish CSRF Class</title> <!------------------------------------>
    <meta name="description" content="Welcome to the bugfish framework github page! Here you can find informations about: Bugfish CSRF Class"> <!------------------------------------>
    <meta name="author" content="Bugfish">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
    <link href="../style.css" rel="stylesheet" type="text/css" />
	<link rel="icon" type="image/x-icon" href="../favicon.ico"><meta property="og:image" content="../meta.png" />
		<link rel="canonical" href="https://bugfishtm.github.io/bugfish-framework/classes/x_class_csrf.html" />
	<meta property="og:title" content="Bugfish CSRF Class" />
	<meta property="og:url" content="https://bugfishtm.github.io/bugfish-framework/classes/x_class_csrf.html" />
	 <link rel="stylesheet" href="../stylesheet.css">
	 <script src="../jquery.js"></script> 
	 <script src="../datatable.js"></script> 
	 <script>
		function internal_show(newshowvar, thiselement) {
			$(".internal_show").hide();
			$(".test").hide();
			$("#"+newshowvar).show();
			$(".navitts").css('color', '');
			thiselement.css('color', '#ff0c02');
		}
		
		
		$( document ).ready(function() {
			$(".internal_show").hide();
			$("#show_php").show();
			$(".startactivenav").css('color', '#ff0c02');
		});		
	 </script>
  </head>
  <body>
<img src="../logo.png" style="width: 100%; margin-bottom: -7px;">    <a href="#header"><div class="gobacktotop"><b>^ Back to Top</b></div></a>   
    <header id="header">
	  
      <h1> CSRF Class</h1>Bugfish Framework <!------------------------------------>
      
      <ul class="main-menu">
        <li><a href="../index.html">Back</a></li>
        <li><a href="#" class="navon">Documentation</a></li>
        <li><a href="https://github.com/bugfishtm/bugfish-framework" target="_blank">Github</a></li>
        <li><a href="https://bugfish.eu" target="_blank" rel="noopener">Bugfish</a></li>
        <li><a href="../impressum.html">Impressum</a></li>
        <li><a href="../privacy.html">Privacy</a></li>
      </ul>                   
    </header>
   
    <div>

				<div class="inner inner_section" style="text-align: center;">
<h2 id="x_class_csrf-mastered-">x_class_csrf </h2>
The x_class_csrf class is designed to manage Cross-Site Request Forgery (CSRF) prevention by generating, validating, and maintaining CSRF tokens within sessions. It provides methods to retrieve tokens, validate submissions, and handle token renewal.

<div style="max-width: 500px;text-align: left; background: 161616;">✔️ Tested<br />
✔️ Productive - Ready<br /><br /></div>

<table>
<thead>
<tr>
<th>Construct Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>__construct($cookie_extension = &quot;&quot;, $second_valid = 300, $external_action = false)</td>
<td> Initializes the class instance. Generates a new session key and saves it to parameters. Sets various settings including the cookie extension, valid time for the CSRF key, and whether to disable renewal for certain actions. Sets the last session keys if they exist.</td>
</tr>
</tbody>
</table>
<hr>
<table>
<thead>
<tr>
<th>Config Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>isDisabled()</td>
<td>Check if renewal is disabled</td>
</tr>
<tr>
<td>norenewal($bool = true)</td>
<td>Disable Key Renewal on Session at end of script</td>
</tr>
<tr>
<td>disableRenewal($bool = false)</td>
<td>Disable Key Renewal on Session at end of script</td>
</tr>
<tr>
<td>external_action($bool = false)</td>
<td>Enable to Disable Renewal for External Actions (optional if set in constructor or renewal deactivated) but needed for dynamic key function!</td>
</tr>
</tbody>
</table>
<hr>
<table>
<thead>
<tr>
<th>Dynamic Key Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>crypto()</td>
<td>Returns either the last session key or the current session key based on whether an external action is being performed or not.</td>
</tr>
<tr>
<td>time()</td>
<td>Returns either the last session key time or the current session key time based on whether an external action is being performed or not.</td>
</tr>
<tr>
<td>validate($code, $override_valid_time = false)</td>
<td>Validates the submitted CSRF code. If $override_valid_time is not provided, it uses the default valid time. Returns true if valid, false otherwise.</td>
</tr>
</tbody>
</table>
<hr>
<table>
<thead>
<tr>
<th>Current Key Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>get()</td>
<td>Get new Generated Key for Forms</td>
</tr>
<tr>
<td>get_time()</td>
<td>Get new Generated Key Time for Forms</td>
</tr>
<tr>
<td>getField($name, $id = &quot;&quot;)</td>
<td>Outputs an HTML hidden input field with the current session key. Useful for embedding CSRF tokens within forms.</td>
</tr>
<tr>
<td>getfield($name, $id = &quot;&quot;)</td>
<td>Print hidden Form Field with name and id attribute</td>
</tr>
<tr>
<td>check($code, $ovr_valid_time = false)</td>
<td>Checks the last session key. Compares the submitted code with the stored last key and validates based on the provided or default valid time. Returns true if valid, false otherwise.</td>
</tr>
</tbody>
</table>
<hr>
<table>
<thead>
<tr>
<th>Last Key [Actions] Functions</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>get_lkey() / get_lkey_time()</td>
<td>Get key/time from last page if exists else “undef”</td>
</tr>
<tr>
<td>check_lkey($code, $ovr_valid_time = false)</td>
<td> Checks the last session key for actions. Compares the submitted code with the stored last key and validates based on the provided or default valid time. Returns true if valid, false otherwise.</td>
</tr>
</tbody>
</table>

</div>


				
 
    </div>
    
  </body>
</html>